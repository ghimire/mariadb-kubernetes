{{- if eq .Values.mariadb.cluster.monitoring.mode "global" }}
- name: metrics
  image: {{ .Values.mariadb.server.monitoring.metricsMonitoring.image }}
  imagePullPolicy: "IfNotPresent"
  env:
  - name: DATA_SOURCE_NAME
    value: "root:@(127.0.0.1:3306)/"
  ports:
  - name: metrics
    containerPort: 9104
{{- end }}
{{- if eq .Values.mariadb.cluster.monitoring.mode "global" }}
- name: logs
  image: {{ .Values.mariadb.server.monitoring.logsMonitoring.image }}
  imagePullPolicy: "Always"
  env:
  - name: MARIADB_CLUSTER_NAME
    value: {{ .Release.Namespace }}
  - name: MARIADB_INFLUXDB_HOST
    value: "influxdb-stardust"
  ports:
  - name: logs
    containerPort: 9104
  volumeMounts:
  - name: logs
    mountPath: /fluentd/log/
{{- end }}
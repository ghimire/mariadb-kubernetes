apiVersion: v1
kind: Pod
metadata:
  name: $(MARIADB_CLUSTER)-sysbench-test
spec:
  restartPolicy: Never
  containers:
  - image: $(IMAGE)
    imagePullPolicy: Always
    name: main
    command: ["/bin/bash", "./run-sysbench.sh"]
    env:
    - name: MARIADB_USER
      valueFrom:
        secretKeyRef:
          name: $(MARIADB_CLUSTER)-mariadb-secret
          key: admin-username
    - name: MARIADB_PASSWORD
      valueFrom:
        secretKeyRef:
          name: $(MARIADB_CLUSTER)-mariadb-secret
          key: admin-password
    - name: MARIADB_HOST
      value: $(MARIADB_CLUSTER)-mariadb
    - name: SYSBENCH_THREADS
      value: "$(SYSBENCH_THREADS)"
    - name: SYSBENCH_NUMBER_OF_TABLES
      value: "$(SYSBENCH_NUMBER_OF_TABLES)"
    - name: SYSBENCH_TABLE_SIZE
      value: "$(SYSBENCH_TABLE_SIZE)"
    - name: SYSBENCH_TIME
      value: "$(SYSBENCH_TIME)"
    - name: SYSBENCH_DELETE_INSERTS
      value: "$(SYSBENCH_DELETE_INSERTS)"
